using System;
using System.Threading.Tasks.Dataflow;

namespace Repeat_After_Me
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.Clear();
            Console.SetCursorPosition(13, 13);
            Console.WriteLine("Your objective is to repeat after me. If I say something, you say it back.");
            Console.ReadLine();
            Console.Clear();
            Console.SetCursorPosition(9, 9);
            Console.WriteLine("You have a limited amount of time to repeat after each phrase is presented to you.");
            Console.ReadLine();
            Console.Clear();
            Console.SetCursorPosition(13, 13);
            Console.WriteLine("And if you run out of time...");
            Console.ReadLine();
            Console.SetCursorPosition(13, 13);
        Start:
            Console.Clear();
            Console.SetCursorPosition(13, 13);
            Console.WriteLine("You lose.");
            Console.ReadLine();
            Console.WriteLine("Press 'R' when you're ready.");
            var userInput = Convert.ToString(Console.ReadLine());
            if (userInput == "R")
            {
                Console.Clear();
                Console.SetCursorPosition(15, 15);
                Console.WriteLine("Ok, let's continue.");
                userInput = null;
            }
            else
            {
                Console.WriteLine("Please press 'R'");
                userInput = null;
                goto Start;
            }


            object[] collection1 = { "a", "b", "repeat", "supper", "conjunction" };
            int Level = 0;
            int badFlag = 0;
            foreach (var item in collection1)
            {
                Console.Clear();
                Console.SetCursorPosition(1, 13);
                Console.WriteLine("Say: " + item);
                var startTime = DateTime.Now.AddSeconds(2);
                Console.WriteLine("starttime " + startTime);
                var userInput1 = Console.ReadLine();
                var endTime = DateTime.Now;
                Console.WriteLine("endtime " + endTime);
                if (userInput1 == Convert.ToString(item))
                {
                    if (endTime < startTime)
                    {
                        Console.WriteLine("Congratulations, you typed in " + item + "Within the alotted time!");
                        Console.WriteLine(endTime);
                        Console.WriteLine(startTime);
                        Console.Clear();
                    }
                    else
                    {
                        Console.WriteLine("You didn't type in: " + item + "Within the alotted time.");
                        badFlag++;
                        Console.WriteLine(endTime);
                        Console.WriteLine(startTime);
                        Console.WriteLine("Strike " + badFlag);
                        System.Threading.Thread.Sleep(1000);
                        if (badFlag == 3) //lose condition
                        {
                            Console.WriteLine("Sorry, three strikes and you're out! Back to the shadow realm with you!");
                            System.Threading.Thread.Sleep(3000);
                            goto Start;
                        }
                    }
                } else
                {
                    Console.WriteLine("You input the statement incorrectly.");
                    badFlag++;
                }
            }
            Console.Clear();
            Console.SetCursorPosition(13, 13);
            Console.WriteLine("Congratulations! You got past level 1!");
            Console.SetCursorPosition(13, 14);
            switch (badFlag)
            {
                case 0:
                    Console.WriteLine("You didn't fail at all! Nicely done!");
                    break;
                case 1:
                    Console.WriteLine("You failed " + badFlag + " Time!");
                    break;
                default:
                    Console.WriteLine("You failed " + badFlag + " Times!");
                    break;

            }
            badFlag = 0;
            System.Threading.Thread.Sleep(5000);
            Console.WriteLine("You got past level 1. Not bad, lets see what else you can do.");
            System.Threading.Thread.Sleep(5000);
            Console.WriteLine("Press 'R' when you're ready.");

            var userInput2 = Convert.ToString(Console.ReadLine());
            if (userInput2 == "R") { }


            Console.Read();


        }
    }
}
